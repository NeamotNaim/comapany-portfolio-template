{"address":"::","code":"EADDRINUSE","errno":-48,"level":"error","message":"Uncaught Exception: listen EADDRINUSE: address already in use :::5000","port":5000,"stack":"Error: listen EADDRINUSE: address already in use :::5000\n    at Server.setupListenHandle [as _listen2] (node:net:1940:16)\n    at listenInCluster (node:net:1997:12)\n    at Server.listen (node:net:2102:7)\n    at Function.listen (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/express/lib/application.js:635:24)\n    at startServer (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/server.js:181:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","syscall":"listen","timestamp":"2025-08-09T01:42:16.587Z"}
{"address":"::","code":"EADDRINUSE","errno":-48,"level":"error","message":"Uncaught Exception: listen EADDRINUSE: address already in use :::5000","port":5000,"stack":"Error: listen EADDRINUSE: address already in use :::5000\n    at Server.setupListenHandle [as _listen2] (node:net:1940:16)\n    at listenInCluster (node:net:1997:12)\n    at Server.listen (node:net:2102:7)\n    at Function.listen (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/express/lib/application.js:635:24)\n    at startServer (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/server.js:181:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","syscall":"listen","timestamp":"2025-08-09T22:20:57.710Z"}
{"address":"::","code":"EADDRINUSE","errno":-48,"level":"error","message":"Uncaught Exception: listen EADDRINUSE: address already in use :::5000","port":5000,"stack":"Error: listen EADDRINUSE: address already in use :::5000\n    at Server.setupListenHandle [as _listen2] (node:net:1940:16)\n    at listenInCluster (node:net:1997:12)\n    at Server.listen (node:net:2102:7)\n    at Function.listen (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/express/lib/application.js:635:24)\n    at startServer (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/server.js:181:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","syscall":"listen","timestamp":"2025-08-09T23:34:01.566Z"}
{"address":"::","code":"EADDRINUSE","errno":-48,"level":"error","message":"Uncaught Exception: listen EADDRINUSE: address already in use :::5000","port":5000,"stack":"Error: listen EADDRINUSE: address already in use :::5000\n    at Server.setupListenHandle [as _listen2] (node:net:1940:16)\n    at listenInCluster (node:net:1997:12)\n    at Server.listen (node:net:2102:7)\n    at Function.listen (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/express/lib/application.js:635:24)\n    at startServer (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/server.js:181:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","syscall":"listen","timestamp":"2025-08-09T23:38:14.853Z"}
{"error":"invalid input syntax for type json","level":"error","message":"Query error","text":"UPDATE services SET title = $1, slug = $2, short_description = $3, full_description = $4, category_id = $5, status = $6, pricing_start = $7, features = $8, technologies = $9, updated_at = CURRENT_TIMESTAMP WHERE id = $10 RETURNING *","timestamp":"2025-08-10T01:46:24.652Z"}
{"code":"22P02","detail":"Expected \":\", but found \",\".","file":"jsonfuncs.c","length":214,"level":"error","line":"631","message":"Update service error: invalid input syntax for type json","name":"error","routine":"json_ereport_error","severity":"ERROR","stack":"error: invalid input syntax for type json\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.update (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:182:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:243:28","timestamp":"2025-08-10T01:46:24.653Z","where":"JSON data, line 1: {\"Predictive Analytics\",...\nunnamed portal parameter $8 = '...'"}
{"error":"invalid input syntax for type json","level":"error","message":"Query error","text":"UPDATE services SET title = $1, slug = $2, short_description = $3, full_description = $4, category_id = $5, status = $6, pricing_start = $7, features = $8, technologies = $9, updated_at = CURRENT_TIMESTAMP WHERE id = $10 RETURNING *","timestamp":"2025-08-10T01:46:27.469Z"}
{"code":"22P02","detail":"Expected \":\", but found \",\".","file":"jsonfuncs.c","length":214,"level":"error","line":"631","message":"Update service error: invalid input syntax for type json","name":"error","routine":"json_ereport_error","severity":"ERROR","stack":"error: invalid input syntax for type json\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.update (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:182:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:243:28","timestamp":"2025-08-10T01:46:27.469Z","where":"JSON data, line 1: {\"Predictive Analytics\",...\nunnamed portal parameter $8 = '...'"}
{"error":"invalid input syntax for type json","level":"error","message":"Query error","text":"INSERT INTO services (title, slug, short_description, full_description, category_id, status, pricing_start, features, technologies) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING *","timestamp":"2025-08-10T01:46:39.837Z"}
{"code":"22P02","detail":"Expected \":\", but found \"}\".","file":"jsonfuncs.c","length":211,"level":"error","line":"631","message":"Create service error: invalid input syntax for type json","name":"error","routine":"json_ereport_error","severity":"ERROR","stack":"error: invalid input syntax for type json\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.create (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:169:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:189:24","timestamp":"2025-08-10T01:46:39.837Z","where":"JSON data, line 1: {\"Et excepturi dolores\"}\nunnamed portal parameter $8 = '...'"}
{"error":"invalid input syntax for type json","level":"error","message":"Query error","text":"INSERT INTO services (title, slug, short_description, full_description, category_id, status, features, technologies, pricing_start) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING *","timestamp":"2025-08-10T01:52:51.041Z"}
{"code":"22P02","detail":"Expected \":\", but found \"}\".","file":"jsonfuncs.c","length":210,"level":"error","line":"631","message":"Create service error: invalid input syntax for type json","name":"error","routine":"json_ereport_error","severity":"ERROR","stack":"error: invalid input syntax for type json\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.create (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:169:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:189:24","timestamp":"2025-08-10T01:52:51.042Z","where":"JSON data, line 1: {\"Sunt labore officii\"}\nunnamed portal parameter $7 = '...'"}
{"error":"invalid input syntax for type json","level":"error","message":"Query error","text":"INSERT INTO services (title, slug, short_description, full_description, category_id, status, features, technologies, pricing_start) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING *","timestamp":"2025-08-10T01:52:58.916Z"}
{"code":"22P02","detail":"Expected \":\", but found \"}\".","file":"jsonfuncs.c","length":210,"level":"error","line":"631","message":"Create service error: invalid input syntax for type json","name":"error","routine":"json_ereport_error","severity":"ERROR","stack":"error: invalid input syntax for type json\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.create (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:169:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:189:24","timestamp":"2025-08-10T01:52:58.916Z","where":"JSON data, line 1: {\"Sunt labore officii\"}\nunnamed portal parameter $7 = '...'"}
{"error":"invalid input syntax for type json","level":"error","message":"Query error","text":"UPDATE services SET title = $1, slug = $2, short_description = $3, full_description = $4, category_id = $5, status = $6, features = $7, technologies = $8, pricing_start = $9, updated_at = CURRENT_TIMESTAMP WHERE id = $10 RETURNING *","timestamp":"2025-08-10T01:53:29.425Z"}
{"code":"22P02","detail":"Expected \":\", but found \",\".","file":"jsonfuncs.c","length":212,"level":"error","line":"631","message":"Update service error: invalid input syntax for type json","name":"error","routine":"json_ereport_error","severity":"ERROR","stack":"error: invalid input syntax for type json\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.update (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:182:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:243:28","timestamp":"2025-08-10T01:53:29.425Z","where":"JSON data, line 1: {\"Native Performance\",...\nunnamed portal parameter $7 = '...'"}
{"error":"invalid input syntax for type json","level":"error","message":"Query error","text":"INSERT INTO services (title, slug, short_description, full_description, category_id, status, features, technologies, pricing_start) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING *","timestamp":"2025-08-10T01:53:52.322Z"}
{"code":"22P02","detail":"Expected \":\", but found \"}\".","file":"jsonfuncs.c","length":211,"level":"error","line":"631","message":"Create service error: invalid input syntax for type json","name":"error","routine":"json_ereport_error","severity":"ERROR","stack":"error: invalid input syntax for type json\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.create (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:169:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:189:24","timestamp":"2025-08-10T01:53:52.323Z","where":"JSON data, line 1: {\"Qui et minim ad ab e\"}\nunnamed portal parameter $7 = '...'"}
{"error":"invalid input syntax for type json","level":"error","message":"Query error","text":"UPDATE services SET title = $1, slug = $2, short_description = $3, full_description = $4, category_id = $5, status = $6, features = $7, technologies = $8, pricing_start = $9, updated_at = CURRENT_TIMESTAMP WHERE id = $10 RETURNING *","timestamp":"2025-08-10T01:53:59.083Z"}
{"code":"22P02","detail":"Expected \":\", but found \",\".","file":"jsonfuncs.c","length":214,"level":"error","line":"631","message":"Update service error: invalid input syntax for type json","name":"error","routine":"json_ereport_error","severity":"ERROR","stack":"error: invalid input syntax for type json\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.update (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:182:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:243:28","timestamp":"2025-08-10T01:53:59.083Z","where":"JSON data, line 1: {\"Financial Management\",...\nunnamed portal parameter $7 = '...'"}
{"error":"multiple assignments to same column \"updated_at\"","level":"error","message":"Query error","text":"UPDATE services SET title = $1, slug = $2, short_description = $3, full_description = $4, category_id = $5, status = $6, features = $7, technologies = $8, pricing_start = $9, updated_at = $10, updated_at = CURRENT_TIMESTAMP WHERE id = $11 RETURNING *","timestamp":"2025-08-10T02:07:59.512Z"}
{"code":"42601","file":"rewriteHandler.c","length":121,"level":"error","line":"1105","message":"Update service error: multiple assignments to same column \"updated_at\"","name":"error","routine":"process_matched_tle","severity":"ERROR","stack":"error: multiple assignments to same column \"updated_at\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.update (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:182:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:297:28","timestamp":"2025-08-10T02:07:59.513Z"}
{"error":"multiple assignments to same column \"updated_at\"","level":"error","message":"Query error","text":"UPDATE services SET title = $1, slug = $2, short_description = $3, full_description = $4, category_id = $5, status = $6, features = $7, technologies = $8, pricing_start = $9, updated_at = $10, updated_at = CURRENT_TIMESTAMP WHERE id = $11 RETURNING *","timestamp":"2025-08-10T02:08:13.132Z"}
{"code":"42601","file":"rewriteHandler.c","length":121,"level":"error","line":"1105","message":"Update service error: multiple assignments to same column \"updated_at\"","name":"error","routine":"process_matched_tle","severity":"ERROR","stack":"error: multiple assignments to same column \"updated_at\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.update (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:182:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:297:28","timestamp":"2025-08-10T02:08:13.133Z"}
{"error":"multiple assignments to same column \"updated_at\"","level":"error","message":"Query error","text":"UPDATE services SET title = $1, slug = $2, short_description = $3, full_description = $4, category_id = $5, status = $6, features = $7, technologies = $8, pricing_start = $9, updated_at = $10, updated_at = CURRENT_TIMESTAMP WHERE id = $11 RETURNING *","timestamp":"2025-08-10T02:08:21.667Z"}
{"code":"42601","file":"rewriteHandler.c","length":121,"level":"error","line":"1105","message":"Update service error: multiple assignments to same column \"updated_at\"","name":"error","routine":"process_matched_tle","severity":"ERROR","stack":"error: multiple assignments to same column \"updated_at\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async Object.update (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:182:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/services.js:297:28","timestamp":"2025-08-10T02:08:21.667Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:02:59.229Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:02:59.229Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:02:59.231Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:02:59.232Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:02:59.233Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:02:59.233Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:02:59.235Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:02:59.235Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:02:59.254Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:02:59.254Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:02:59.254Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:02:59.254Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:02:59.256Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:02:59.256Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:02:59.257Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:02:59.257Z"}
{"address":"::","code":"EADDRINUSE","errno":-48,"level":"error","message":"Uncaught Exception: listen EADDRINUSE: address already in use :::5001","port":5001,"stack":"Error: listen EADDRINUSE: address already in use :::5001\n    at Server.setupListenHandle [as _listen2] (node:net:1940:16)\n    at listenInCluster (node:net:1997:12)\n    at Server.listen (node:net:2102:7)\n    at Function.listen (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/express/lib/application.js:635:24)\n    at startServer (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/server.js:183:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","syscall":"listen","timestamp":"2025-08-10T21:03:36.277Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:04:00.723Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:04:00.723Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:04:00.724Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:04:00.724Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:04:00.725Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:04:00.725Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:04:00.726Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:04:00.726Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:04:00.731Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:04:00.731Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:04:00.735Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:04:00.735Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:04:00.735Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:04:00.735Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:04:00.736Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:04:00.736Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:04:01.831Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:04:01.831Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:04:01.835Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:04:01.836Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:04:01.841Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:04:01.841Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:04:01.844Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:04:01.844Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:04:01.847Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:04:01.847Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:04:01.849Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:04:01.849Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:04:01.850Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:04:01.850Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:04:01.851Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:04:01.851Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:04:02.552Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:04:02.553Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:04:02.556Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:04:02.557Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:04:02.565Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:04:02.565Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:04:02.567Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:04:02.567Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:04:02.571Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:04:02.571Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:04:02.572Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:04:02.572Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:04:02.573Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:04:02.573Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:04:02.575Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:04:02.575Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:06:26.751Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:06:26.751Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:06:26.752Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:06:26.752Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:06:26.752Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:06:26.753Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:06:26.753Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:06:26.753Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:06:26.756Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:06:26.756Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:06:26.758Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:06:26.759Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:06:26.759Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:06:26.759Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:06:26.759Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:06:26.760Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:06:27.366Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:06:27.366Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:06:27.372Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:06:27.372Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:06:27.374Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:06:27.374Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:06:27.375Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:06:27.375Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:06:27.381Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:06:27.381Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:06:27.382Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:06:27.383Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:06:27.385Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:06:27.385Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:06:27.386Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:06:27.386Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:06:27.735Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:06:27.736Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:06:27.736Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:06:27.737Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:06:27.744Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:06:27.744Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:06:27.745Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:06:27.745Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:06:27.752Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:06:27.752Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:06:27.754Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:06:27.755Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:06:27.756Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:06:27.756Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:06:27.756Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:06:27.756Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:06:28.793Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:06:28.794Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:06:28.802Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:06:28.802Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:06:28.827Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:06:28.827Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:06:28.829Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:06:28.829Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:06:44.472Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:84:20","timestamp":"2025-08-10T21:06:44.473Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:06:44.478Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:258:27","timestamp":"2025-08-10T21:06:44.478Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:06:44.480Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:209:20","timestamp":"2025-08-10T21:06:44.480Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT\n        status,\n        COUNT(*) as count,\n        COALESCE(SUM(conversion_value), 0) as total_value\n      FROM leads\n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY status\n      ORDER BY count DESC\n    ","timestamp":"2025-08-10T21:06:44.482Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get lead analytics error: syntax error at or near \"$1\"","name":"error","position":"188","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:344:26","timestamp":"2025-08-10T21:06:44.483Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:29:17.936Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:257:20","timestamp":"2025-08-10T21:29:17.936Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:29:17.936Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:306:27","timestamp":"2025-08-10T21:29:17.936Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:29:17.937Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T21:29:17.937Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T21:29:17.939Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T21:29:17.947Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:29:17.948Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T21:29:17.948Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:29:17.948Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:257:20","timestamp":"2025-08-10T21:29:17.948Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:29:17.949Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:306:27","timestamp":"2025-08-10T21:29:17.949Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:53:26.126Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:306:27","timestamp":"2025-08-10T21:53:26.126Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:53:26.128Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:257:20","timestamp":"2025-08-10T21:53:26.128Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:53:26.134Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T21:53:26.137Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T21:53:26.140Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T21:53:26.153Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:53:26.158Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:306:27","timestamp":"2025-08-10T21:53:26.158Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:53:26.159Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:257:20","timestamp":"2025-08-10T21:53:26.159Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:53:26.161Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T21:53:26.161Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:53:26.801Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:257:20","timestamp":"2025-08-10T21:53:26.801Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:53:26.802Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T21:53:26.803Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T21:53:26.805Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:53:26.808Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:306:27","timestamp":"2025-08-10T21:53:26.808Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T21:53:26.813Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:53:26.818Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T21:53:26.818Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:53:26.818Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:257:20","timestamp":"2025-08-10T21:53:26.818Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:53:26.821Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:306:27","timestamp":"2025-08-10T21:53:26.821Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T21:57:23.259Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:57:23.263Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:306:27","timestamp":"2025-08-10T21:57:23.263Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:57:23.270Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T21:57:23.271Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:57:23.271Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:257:20","timestamp":"2025-08-10T21:57:23.271Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T21:57:23.306Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      SELECT \n        DATE(created_at) as date,\n        COUNT(*) as page_views,\n        COUNT(DISTINCT session_id) as unique_sessions,\n        COUNT(DISTINCT ip_address) as unique_visitors,\n        COUNT(DISTINCT page_path) as unique_pages\n      FROM analytics_events \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      GROUP BY DATE(created_at)\n      ORDER BY date\n    ","timestamp":"2025-08-10T21:57:23.310Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get traffic analytics error: syntax error at or near \"$1\"","name":"error","position":"326","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:306:27","timestamp":"2025-08-10T21:57:23.310Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T21:57:23.320Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T21:57:23.320Z"}
{"error":"syntax error at or near \"$2\"","level":"error","message":"Query error","text":"\n      SELECT \n        TO_CHAR(created_at, $1) as period,\n        COUNT(*) as leads_count,\n        COUNT(CASE WHEN status = 'converted' THEN 1 END) as conversions,\n        COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as revenue,\n        COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value\n      FROM leads \n      WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $2\n      GROUP BY TO_CHAR(created_at, $1)\n      ORDER BY period\n    ","timestamp":"2025-08-10T21:57:23.324Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get revenue analytics error: syntax error at or near \"$2\"","name":"error","position":"434","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$2\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:257:20","timestamp":"2025-08-10T21:57:23.324Z"}
{"address":"::","code":"EADDRINUSE","errno":-48,"level":"error","message":"Uncaught Exception: listen EADDRINUSE: address already in use :::5001","port":5001,"stack":"Error: listen EADDRINUSE: address already in use :::5001\n    at Server.setupListenHandle [as _listen2] (node:net:1939:16)\n    at listenInCluster (node:net:1996:12)\n    at Server.listen (node:net:2101:7)\n    at Function.listen (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/express/lib/application.js:635:24)\n    at startServer (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/server.js:183:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","syscall":"listen","timestamp":"2025-08-10T22:12:08.196Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:12:34.124Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T22:12:34.124Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:12:34.129Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:12:34.134Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T22:12:34.134Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:12:34.137Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:12:45.338Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T22:12:45.338Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:12:45.355Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T22:12:45.355Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:12:45.356Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:12:45.360Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:13:55.024Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T22:13:55.024Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:13:55.031Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:13:55.036Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T22:13:55.036Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:13:55.039Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:14:55.108Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T22:14:55.109Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:14:55.109Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:14:55.116Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T22:14:55.116Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:14:55.120Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:15:19.349Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T22:15:19.349Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:15:19.355Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:16:57.546Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:16:57.546Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:132:20","timestamp":"2025-08-10T22:16:57.547Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:18:10.029Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:18:10.030Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:224:20","timestamp":"2025-08-10T22:18:10.030Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:18:10.045Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:18:10.046Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:224:20","timestamp":"2025-08-10T22:18:10.046Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:18:11.317Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:18:11.318Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:224:20","timestamp":"2025-08-10T22:18:11.318Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:18:11.333Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:18:11.334Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:224:20","timestamp":"2025-08-10T22:18:11.334Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:19:16.755Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:19:16.758Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:224:20","timestamp":"2025-08-10T22:19:16.758Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:19:16.764Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:224:20","timestamp":"2025-08-10T22:19:16.764Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:19:16.764Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:19:18.005Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:224:20","timestamp":"2025-08-10T22:19:18.005Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n      WITH lead_stats AS (\n        SELECT \n          COUNT(*) as total_leads,\n          COUNT(CASE WHEN status = 'new' THEN 1 END) as new_leads,\n          COUNT(CASE WHEN status = 'converted' THEN 1 END) as converted_leads,\n          COALESCE(AVG(CASE WHEN status = 'converted' THEN conversion_value END), 0) as avg_deal_value,\n          COALESCE(SUM(CASE WHEN status = 'converted' THEN conversion_value END), 0) as total_revenue\n        FROM leads WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      ),\n      service_stats AS (\n        SELECT \n          COUNT(*) as total_services,\n          COUNT(CASE WHEN status = 'active' THEN 1 END) as active_services\n        FROM services\n      ),\n      analytics_stats AS (\n        SELECT \n          COUNT(*) as total_page_views,\n          COUNT(DISTINCT session_id) as unique_sessions,\n          COUNT(DISTINCT ip_address) as unique_visitors\n        FROM analytics_events WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n      )\n      SELECT \n        ls.*,\n        ss.*,\n        ans.*,\n        CASE \n          WHEN ls.total_leads > 0 THEN ROUND((ls.converted_leads::decimal / ls.total_leads::decimal) * 100, 2)\n          ELSE 0 \n        END as conversion_rate\n      FROM lead_stats ls, service_stats ss, analytics_stats ans\n    ","timestamp":"2025-08-10T22:19:18.009Z"}
{"code":"42601","file":"scan.l","length":92,"level":"error","line":"1180","message":"Get analytics overview error: syntax error at or near \"$1\"","name":"error","position":"500","routine":"scanner_yyerror","severity":"ERROR","stack":"error: syntax error at or near \"$1\"\n    at /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/config/database.js:60:20)\n    at async /Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/routes/analytics.js:224:20","timestamp":"2025-08-10T22:19:18.009Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:19:18.012Z"}
{"error":"syntax error at or near \"$1\"","level":"error","message":"Query error","text":"\n        SELECT\n          status,\n          COUNT(*) as count,\n          COALESCE(SUM(conversion_value), 0) as total_value\n        FROM leads\n        WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL $1\n        GROUP BY status\n        ORDER BY count DESC\n      ","timestamp":"2025-08-10T22:19:18.018Z"}
{"address":"::","code":"EADDRINUSE","errno":-48,"level":"error","message":"Uncaught Exception: listen EADDRINUSE: address already in use :::5001","port":5001,"stack":"Error: listen EADDRINUSE: address already in use :::5001\n    at Server.setupListenHandle [as _listen2] (node:net:1939:16)\n    at listenInCluster (node:net:1996:12)\n    at Server.listen (node:net:2101:7)\n    at Function.listen (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/node_modules/express/lib/application.js:635:24)\n    at startServer (/Users/neamotullahnaim/Project/Cursor/Company-portfolio/Company-portfolio/backend/server.js:189:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","syscall":"listen","timestamp":"2025-08-11T01:12:16.908Z"}
{"level":"error","message":"Token verification failed:","timestamp":"2025-08-11T01:13:05.221Z"}
